---
import { projects } from "@docs/projects.json";
import { Icon } from "astro-icon/components";

import ProjectCard from "@components/ProjectCard.astro";
import Carousel from "@components/Carousel.astro";
import Main from "@layouts/Main.astro";
---

<Main>
    <article class="md:mx-20 p-5 flex flex-col gap-20">
        <section class="animate-on-scroll">
            <figure
                class="relative w-full rounded-2xl"
                style="height: calc(100vh - 120px);"
            >
                <img
                    class="h-full w-full object-cover object-right rounded-2xl pointer-events-none"
                    src="images/me.jpg"
                    alt="Foto de perfil de Dylan Cantillo Arrieta"
                    loading="lazy"
                />
                <div
                    class="absolute left-0 bottom-0 flex flex-col justify-start items-start gap-0"
                >
                    <div
                        class="relative px-4 md:px-8 py-4 rounded-se-2xl text-6xl font-bold bg-catskill-white-50"
                    >
                        <h1 class="max-sm:text-3xl">Dylan</h1>
                        <Icon
                            class="absolute left-full bottom-0 text-catskill-white-50 -rotate-90"
                            name="inrounded-corner"
                            size={20}
                        />
                        <Icon
                            class="absolute left-0 bottom-full text-catskill-white-50 -rotate-90"
                            name="inrounded-corner"
                            size={20}
                        />
                    </div>
                    <div
                        class="relative px-4 md:px-8 py-4 rounded-se-2xl text-6xl font-bold bg-catskill-white-50"
                    >
                        <h1 class="max-sm:text-3xl">Cantillo Arrieta</h1>
                        <Icon
                            class="absolute left-full bottom-0 text-catskill-white-50 -rotate-90"
                            name="inrounded-corner"
                            size={20}
                        />
                    </div>
                </div>
            </figure>
        </section>
        <section class="flex items-center justify-center animate-on-scroll">
            <div class="flex flex-col gap-5 max-w-[900px] text-center">
                <p class="text-3xl font-bold">Backend Engineer (Data & Analytics)</p>
                <p class="mx-2">
                    Ingeniero de Sistemas y Matemático con 4 años de experiencia como Backend Engineer con enfoque en data/analytics. He construido y optimizado sistemas con reglas de negocio complejas, desarrollando APIs y componentes de producto en Python y JavaScript, e integrando datos para métricas operativas y toma de decisiones. Pensando siempre en el cliente final. Me muevo cómodo entre el mundo de ingeniería y el de analítica: desde el diseño de modelos/consultas hasta la entrega de KPIs consumibles por negocio. Priorizo entregables medibles: performance, mantenibilidad, trazabilidad y automatización.
                </p>
            </div>
        </section>
        <section class="flex flex-col gap-5 animate-on-scroll">
            <div class="flex items-center justify-between">
                <p class="text-2xl font-bold">Top Proyectos</p>
                <a
                    class="px-5 border-b border-black font-semibold"
                    href="/projects">Ver todos</a
                >
            </div>
            <Carousel gap={40}>
                {
                    projects
                        .filter(({ top }) => top)
                        .map(({ title, description, image, link, tag }) => (
                            <ProjectCard
                                title={title}
                                description={description}
                                image={image}
                                link={link}
                                tag={tag}
                            />
                        ))
                }
            </Carousel>
        </section>
    </article>

    <script>
        function initScrollAnimations() {
            const observer = new IntersectionObserver(
                (entries) => {
                    entries.forEach((entry) => {
                        if (entry.isIntersecting) {
                            entry.target.classList.add("is-visible");
                            observer.unobserve(entry.target);
                        }
                    });
                },
                { threshold: 0.1 }
            );

            document.querySelectorAll(".animate-on-scroll").forEach((el) => {
                el.classList.remove("is-visible");
                observer.observe(el);
            });
        }

        initScrollAnimations();
        document.addEventListener("astro:page-load", initScrollAnimations);
    </script>
</Main>
